!function(){var t=document.createElement("style");t.innerHTML=".el-button--primary[data-v-00538f19]{margin-left:25px;margin-right:5px}.el-checkbox[data-v-00538f19]{width:20%}.more[data-v-00538f19]{margin-left:1.75rem;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAbCAYAAAB836/YAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTQyIDc5LjE2MDkyNCwgMjAxNy8wNy8xMy0wMTowNjozOSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo4MUQ5MUJCNkEzRkYxMUVCQTE1NUVDNDc5MDNFOTc4OSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo4MUQ5MUJCN0EzRkYxMUVCQTE1NUVDNDc5MDNFOTc4OSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjgxRDkxQkI0QTNGRjExRUJBMTU1RUM0NzkwM0U5Nzg5IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjgxRDkxQkI1QTNGRjExRUJBMTU1RUM0NzkwM0U5Nzg5Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+B0oTKQAAAE9JREFUeNpi/P//PwM1ARMDlcGogUPUQE8gfgbFnoQUMxKRDkEGSULZz4FYippeZqSGl1OA+AUQPwXiZGp4eTQdjibs0YQ9mg5HgoEAAQYAMKsdCdjHQ/QAAAAASUVORK5CYII=) center center no-repeat;background-size:contain;float:left;border-radius:.3125rem;-webkit-border-radius:.3125rem;-moz-border-radius:.3125rem;-ms-border-radius:.3125rem;-o-border-radius:.3125rem;overflow:hidden;transition:all .3s;-webkit-transition:all .3s;-moz-transition:all .3s;-ms-transition:all .3s;-o-transition:all .3s;cursor:pointer}.jbThead[data-v-00538f19]{font-size:14px;color:#515a6e}.ul-detail .inner[data-v-00538f19]{padding:.625rem 0 .625rem .3rem}.ul-detail .s3 .tit[data-v-00538f19],.ul-detail .s4 .tit[data-v-00538f19]{min-width:10em}.ul-detail .s1 .tit[data-v-00538f19]{margin-right:0;min-width:4.8em}.valuepile[data-v-00538f19]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.ul-detail li[data-v-00538f19]{padding:0 1.3rem 0 0}.ul-detail li[data-v-00538f19]:first-child{padding-left:1.3rem}\n",document.head.appendChild(t),System.register(["./report-legacy.5def1dd2.js","./index-legacy.189d0d97.js","./moment-legacy.d336d678.js","./api-legacy.967aef36.js","./gTabs-legacy.cd931363.js","./gTabs.vue_vue_type_style_index_0_scoped_true_lang-legacy.6ffcbfbe.js"],(function(t){"use strict";var e,a,i,s,r,l,n,o;return{setters:[function(t){e=t.r},function(t){a=t.n},function(t){i=t.h,s=t.i,r=t.c},function(t){l=t.q,n=t.i},function(t){o=t.g},function(){}],execute:function(){var c=["pileDescribe","deviceKey","beginTime","endTime","depth","frDepth","reDepth","waterCementRatio","cumulativePulp","averagePulp","cumulativeAsh","averageAsh","pileTopCurrent","maxCurrent","downSpeed","upSpeed","averageCurrent","maxDownSpeed","maxUpSpeed","xAngle","pileTime","tTypeLength","tTypePulp","tTypeAsh","bottomPartPulp","bottomPartAsh","emDepth","warnreason"],h={},p=a({components:{gTabs:o,report:e},data:function(){return{report:"report",pageSize:10,total:0,currentPage:1,deviceList:[],tableData:[],tab:"JBZ",pileDescribe:"",device:"",totalChecked:!1,checkedId:[],paramsList:[{label:"参数1",value:"参数1"},{label:"参数2",value:"参数2"}],checkAll:!1,checkedFileds:["pileDescribe","deviceKey","beginTime","depth","cumulativeAsh","upSpeed","downSpeed","warnreason"],fieldNames:[{prop:"pileDescribe",label:"桩号"},{prop:"deviceKey",label:"设备编号"},{prop:"beginTime",label:"开始时间",formatter:this.testFormatter},{prop:"endTime",label:"结束时间",formatter:this.testFormatter},{prop:"depth",label:"施工桩长(m)",formatter:this.numFormatter},{prop:"frDepth",label:"初搅深度(m)",formatter:this.numFormatter},{prop:"reDepth",label:"复搅深度(m)",formatter:this.numFormatter},{prop:"waterCementRatio",label:"水灰比",formatter:this.numFormatter},{prop:"cumulativePulp",label:"累计浆量(L)",formatter:this.numFormatter},{prop:"averagePulp",label:"平均浆量(L/m)",formatter:this.numFormatter},{prop:"cumulativeAsh",label:"累计灰量(kg)",formatter:this.numFormatter},{prop:"averageAsh",label:"平均灰量(kg/m)",formatter:this.numFormatter},{prop:"pileTopCurrent",label:"桩端电流(A)",formatter:this.numFormatter},{prop:"maxCurrent",label:"最大电流(A)",formatter:this.numFormatter},{prop:"downSpeed",label:"下钻速度(cm/min)",formatter:this.numFormatter},{prop:"upSpeed",label:"提钻速度(cm/min)",formatter:this.numFormatter},{prop:"averageCurrent",label:"平均电流(A)",formatter:this.numFormatter},{prop:"maxDownSpeed",label:"最大钻速(cm/min)",formatter:this.numFormatter},{prop:"maxUpSpeed",label:"最大提速(cm/min)",formatter:this.numFormatter},{prop:"xAngle",label:"最大斜度(%)",formatter:this.num1Formatter},{prop:"pileTime",label:"成桩时间(min)\t",formatter:this.minFormatter},{prop:"tTypeLength",label:"扩大头桩长(m)\t",formatter:this.numFormatter},{prop:"tTypePulp",label:"扩大头浆量(L)",formatter:this.numFormatter},{prop:"tTypeAsh",label:"扩大头灰量(kg)",formatter:this.numFormatter},{prop:"bottomPartPulp",label:"下部桩浆量(L)",formatter:this.numFormatter},{prop:"bottomPartAsh",label:"下部桩灰量(kg)",formatter:this.numFormatter},{prop:"emDepth",label:"空搅深度(m)",formatter:this.numFormatter},{prop:"warnreason",label:"预警原因"}],isIndeterminate:!1,dialogFormVisible:!1,cols:[{prop:"pileDescribe",label:"桩号"},{prop:"deviceKey",label:"设备编号"},{prop:"beginTime",label:"开始时间",formatter:this.testFormatter},{prop:"depth",label:"桩长(m)",formatter:this.numFormatter},{prop:"cumulativeAsh",label:"累计灰量(kg)",formatter:this.numFormatter},{prop:"upSpeed",label:"提钻速度(cm/min)",formatter:this.numFormatter},{prop:"downSpeed",label:"下钻速度(cm/min)",formatter:this.numFormatter},{prop:"warnreason",label:"预警原因"}],tempCols:[],centerDialogVisible:!1,data:[],selectItem:[],tab2:0,tab2List:[{name:"详细内容"},{name:"图表曲线"}],config:{},depth:[],asherror:[],timeerror:[],checkedData:[],depthReport:[],pulpReport:{},ashReport:{},upspeed:{},downspeed:{},partcurrent:{},echartsAll:[]}},mounted:function(){var t=this;l(9999,1,this.tab).then((function(e){t.deviceList=e.result.records})),n(this.tab,0,this.device,this.pageSize,this.pileDescribe).then((function(e){t.tableData=e.content,t.total=e.totalElements,t.warnReason()}))},filters:{datafilters:function(t){return i(1e3*t).format("YYYY-MM-DD HH:mm:ss")},numfilters:function(t){return parseFloat(t).toFixed(2)},minfilters:function(t){return(parseFloat(t)/60).toFixed(2)},num1filters:function(t){return parseFloat(t).toFixed(2)},num2filters:function(t){return parseFloat(t).toFixed(3)},num3filters:function(t){return Math.abs(parseFloat(t).toFixed(2))},num5filters:function(t){return t<0?"提钻":"下钻"},densityfilter:function(t){return 0==t?t:parseFloat(1+1/(3*t+1)*2).toFixed(3)}},watch:{centerDialogVisible:function(t,e){if(0==t){if(this.tab2=0,this.selectItem=[],this.data=[],this.upspeed=[],this.downspeed=[],this.ashReport=[],this.depthReport=[],this.partcurrent=[],null==this.myChart01)return;this.myChart01.dispose(),this.myChart02.dispose(),this.myChart03.dispose(),this.myChart04.dispose()}}},methods:{warnReason:function(){for(var t=0;t<this.tableData.length;t++)this.tableData[t].ashError>0&&(this.tableData[t].warnreason="灰量不足:"+(100*this.tableData[t].ashError).toFixed(2)+"%"),this.tableData[t].upSpeedError>0&&(this.tableData[t].warnreason="提速超标:"+(100*this.tableData[t].upSpeedError).toFixed(2)+"%"),this.tableData[t].downSpeedError>0&&(this.tableData[t].warnreason="钻速超标:"+(100*this.tableData[t].downSpeedError).toFixed(2)+"%"),this.tableData[t].ashError>0&&this.tableData[t].upSpeedError>0&&this.tableData[t].downSpeedError>0&&(this.tableData[t].warnreason="灰量不足:"+(100*this.tableData[t].ashError).toFixed(2)+"%提速超标:"+(100*this.tableData[t].upSpeedError).toFixed(2)+"%钻速超标:"+(100*this.tableData[t].downSpeedError).toFixed(2)+"%"),this.tableData[t].ashError>0&&this.tableData[t].upSpeedError>0&&this.tableData[t].downSpeedError<0&&(this.tableData[t].warnreason="灰量不足:"+(100*this.tableData[t].ashError).toFixed(2)+"%提速超标:"+(100*this.tableData[t].upSpeedError).toFixed(2)+"%"),this.tableData[t].ashError>0&&this.tableData[t].upSpeedError<0&&this.tableData[t].downSpeedError>0&&(this.tableData[t].warnreason="灰量不足:"+(100*this.tableData[t].ashError).toFixed(2)+"%钻速超标:"+(100*this.tableData[t].downSpeedError).toFixed(2)+"%"),this.tableData[t].ashError<0&&this.tableData[t].upSpeedError>0&&this.tableData[t].downSpeedError>0&&(this.tableData[t].warnreason="提速超标:"+(100*this.tableData[t].upSpeedError).toFixed(2)+"%钻速超标:"+(100*this.tableData[t].downSpeedError).toFixed(2)+"%")},backgroundColor:function(t,e,a,i){if("upSpeed"==t.column.property){if(0==t.row.upSpeedError)return{color:"#ff3333"};if(t.row.upSpeedError>0)return{color:"#DAA520"}}if("cumulativeAsh"==t.column.property){if(0==t.row.ashError)return{color:"#ff3333"};if(t.row.ashError>0)return{color:"#DAA520"}}if("downSpeed"==t.column.property){if(0==t.row.downSpeedError)return{color:"#ff3333"};if(t.row.downSpeedError>0)return{color:"#DAA520"}}},checkall:function(){this.tableToExcel("statisticsTableRecord","-搅拌桩-统计报表")},downLoad:function(t){switch(t){case 0:this.tableToExcel("statisticsTablePrint",i(1e3*this.selectItem.beginTime).format("YYYY-MM-DD")+"-搅拌桩-打印版");break;case 1:this.tableToExcel("statisticsTable",i(1e3*this.selectItem.beginTime).format("YYYY-MM-DD")+"-搅拌桩-综合版");break;case 2:this.tableToExcel("statisticsTabledetailed",i(1e3*this.selectItem.beginTime).format("YYYY-MM-DD")+"-搅拌桩_详细版")}},tableToExcel:function(t,e){var a;t.nodeType||(t=document.getElementById(t)),t&&(a={worksheet:e||"Worksheet",table:t.innerHTML},document.getElementById("simulation").href="data:application/vnd.ms-excel;base64,"+this.base64(this.format('<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel"xmlns="http://www.w3.org/TR/REC-html40"><head>\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e <style type="text/css">table td {height: 25px;font-family: 宋体;font-size: 13px;text-align: left;border: 0.5px solid #000000; }table .tHead {font-size: 20px;text-align:center;font-weight: bold;height: 40px; }table tfoot tr{height: 25px; }table tbody td{text-align: center;height: 20px;mso-number-format:"@"; }</style></head><body ><table class="excelTable">{table}</table></body></html>',a)),document.getElementById("simulation").download=e+".xls",document.getElementById("simulation").click())},base64:function(t){return window.btoa(unescape(encodeURIComponent(t)))},format:function(t,e){return t.replace(/{(\w+)}/g,(function(t,a){return e[a]}))},querychxun:function(){var t=this;n("",0,this.device,this.pageSize,this.pileDescribe).then((function(e){t.tableData=e.content,t.total=e.totalElements,t.warnReason()}))},resetClick:function(){this.device="",this.pileDescribe=""},testFormatter:function(t,e,a,s){return i(1e3*a).format("YYYY-MM-DD HH:mm:ss")},numFormatter:function(t,e,a,i){return parseFloat(a).toFixed(2)},minFormatter:function(t,e,a,i){return(parseFloat(a)/60).toFixed(0)},num1Formatter:function(t,e,a,i){return parseFloat(a).toFixed(2)+"%"},handleCheckAllChange:function(t){this.checkedFileds=t?c:[],this.isIndeterminate=!1},handleCheckedCitiesChange:function(t){var e=t.length;this.checkAll=e===this.fieldNames.length,this.isIndeterminate=e>0&&e<this.fieldNames.length},showData:function(t){this.dialogFormVisible=!0},confirmShow:function(){if(this.tempCols=[],this.checkedFileds.length<1)this.$message.warning("请至少选择一项数据"),this.dialogFormVisible=!0;else{for(var t=0;t<this.fieldNames.length;t++)for(var e=0;e<this.checkedFileds.length;e++)this.fieldNames[t].prop==this.checkedFileds[e]&&this.tempCols.push(this.fieldNames[t]);this.cols=this.tempCols,this.dialogFormVisible=!1}},initEchart01:function(){var t=this.data,e={title:{text:"深度、密度曲线",textStyle:{color:"#101D34",fontSize:16},left:"2.2%",top:"5%"},tooltip:{trigger:"axis"},legend:{top:"5%",right:"10%",data:["深度","密度"]},grid:{top:"23%",left:"3%",right:"3%",bottom:"13%",containLabel:!0},xAxis:{type:"time",axisLabel:{interval:10,formatter:"{HH}:{mm}"}},yAxis:[{name:"深度          ",type:"value",inverse:!0,nameLocation:"end",axisLine:{show:!0},nameTextStyle:{padding:[10,0,0,15]}},{name:"          密度",nameLocation:"end",inverse:!0,type:"value",splitLine:{show:!1},nameTextStyle:{padding:[10,15,0,0]}}],series:[{name:"深度",type:"line",showSymbol:!1,data:this.selectItem.data.map((function(e,a){return[t[a],e.partDeep]}))},{name:"密度",yAxisIndex:1,type:"line",splitLine:{lineStyle:{type:"dashed"}},showSymbol:!1,data:this.selectItem.data.map((function(e,a){return[t[a],e.partDensity.toFixed(3)+""]}))}]};this.myChart01=s(this.$refs.myChart01,null,{renderer:"svg"}),this.myChart01.setOption(e),this.echartsAll.push(this.myChart01)},initEchart02:function(){var t=this.data,e={title:{text:"钻杆深度电流曲线",textStyle:{color:"#101D34",fontSize:16},left:"2.2%",top:"5%"},tooltip:{trigger:"axis"},legend:{top:"5%",right:"10%",data:["深度","电流"]},grid:{top:"23%",left:"3%",right:"3%",bottom:"13%",containLabel:!0},xAxis:{type:"time",axisLabel:{interval:10,formatter:"{HH}:{mm}"}},yAxis:[{name:"深度       ",type:"value",inverse:!0,nameLocation:"end",axisLine:{show:!0},nameTextStyle:{padding:[10,0,0,15]}},{name:"      电流",type:"value",nameLocation:"start",splitLine:{show:!1},nameTextStyle:{padding:[10,15,0,0]}}],series:[{name:"深度",type:"line",showSymbol:!1,data:this.selectItem.data.map((function(e,a){return[t[a],e.partDeep]}))},{name:"电流",yAxisIndex:1,type:"line",splitLine:{lineStyle:{type:"dashed"}},showSymbol:!1,data:this.selectItem.data.map((function(e,a){return[t[a],e.partCurrent.toFixed(2)]}))}]};this.myChart02=s(this.$refs.myChart02,null,{renderer:"svg"}),this.myChart02.setOption(e),this.echartsAll.push(this.myChart02)},initEchart03:function(){var t=this.data,e={title:{text:"流量、速度变化曲线",textStyle:{color:"#101D34",fontSize:16},left:"2.2%",top:"5%"},tooltip:{trigger:"axis"},legend:{top:"5%",right:"10%",data:["流量","速度"]},grid:{top:"23%",left:"3%",right:"3%",bottom:"13%",containLabel:!0},xAxis:{type:"time",axisLabel:{interval:10,formatter:"{HH}:{mm}"}},yAxis:[{name:"流量(L/min)",type:"value",nameLocation:"start",axisLine:{show:!0},nameTextStyle:{padding:[10,0,0,15]},max:100},{name:"速度(cm/min)      ",type:"value",nameLocation:"start",splitLine:{show:!1},nameTextStyle:{padding:[10,15,0,0]}}],series:[{name:"流量",type:"line",showSymbol:!1,data:this.selectItem.data.map((function(e,a){return[t[a],(e.partPulp/e.partTime*60).toFixed(2)]}))},{name:"速度",yAxisIndex:1,type:"line",splitLine:{lineStyle:{type:"dashed"}},showSymbol:!1,data:this.selectItem.data.map((function(e,a){return[t[a],e.partDownSpeed.toFixed(2)]}))}]};this.myChart03=s(this.$refs.myChart03,null,{renderer:"svg"}),this.myChart03.setOption(e),this.echartsAll.push(this.myChart03)},initEchart04:function(){for(var t=[],e=0;e<this.selectItem.data.length;e++)null==t[Math.ceil(this.selectItem.data[e].partDeep-1)]&&(t[Math.ceil(this.selectItem.data[e].partDeep-1)]=0),t[Math.ceil(this.selectItem.data[e].partDeep-1)]+=this.selectItem.data[e].partAsh;var a={title:{text:"成桩灰量分布",textStyle:{color:"#101D34",fontSize:16},left:"2.2%",top:"5%"},tooltip:{trigger:"item",formatter:"{a} : {c}"},grid:{top:"10%",bottom:"10%"},series:[{name:"成桩灰量分布",type:"funnel",width:"50%",left:"center",top:"15%",bottom:"8%",label:{show:!0},labelLine:{show:!0},data:t.map((function(t,e,a){return{value:Number(t.toFixed(2)),name:e+1}})),sort:"none",color:"#5470c6"}]};this.myChart04=s(this.$refs.myChart04,null,{renderer:"svg"}),this.myChart04.setOption(a)},changeHandle:function(t){var e=this,a=this;this.tab2=t,1===t&&this.$nextTick((function(){e.initEchart01(),e.initEchart02(),e.initEchart03(),r(e.echartsAll),e.initEchart04(),window.onresize=function(){a.myChart01.resize(),a.myChart02.resize(),a.myChart03.resize(),a.myChart04.resize()}}))},handleCommand:function(t){var e=this;this.selectItem=this.tableData[t],this.centerDialogVisible=!0;for(var a,s=this.selectItem.beginTime,r=[],l=[],n=[],o=[],c=[],h=[],p=new Map,d=new Map,m=0;m<this.tableData[t].data.length;m++){s+=this.tableData[t].data[m].partTime,a=i(1e3*s).format("YYYY-MM-DD HH:mm:ss"),this.data.push(a),0!=this.tableData[t].data[m].partDeep&&this.depthReport.push(Math.ceil(this.tableData[t].data[m].partDeep));for(var u=0;u<this.depthReport.length;u++)for(var f=u+1;f<this.depthReport.length;f++)this.depthReport[u]==this.depthReport[f]&&(this.depthReport.splice(f,1),f--);if(this.tableData[t].data[m].partDeep==Math.floor(this.tableData[t].data[m].partDeep)+.25){var v={key:Math.floor(this.tableData[t].data[m].partDeep)+.25,value:Number(this.tableData[t].data[m].partPulp)};r.push(v);var b={};r.forEach((function(t){b[t.key]?b[t.key]+=t.value:b[t.key]=t.value}))}if(this.tableData[t].data[m].partDeep==Math.floor(this.tableData[t].data[m].partDeep)+.5){var g={key:Math.floor(this.tableData[t].data[m].partDeep)+.5,value:Number(this.tableData[t].data[m].partPulp.toFixed(2))};l.push(g);var D={};l.forEach((function(t){D[t.key]?D[t.key]+=t.value:D[t.key]=t.value}))}if(this.tableData[t].data[m].partDeep==Math.floor(this.tableData[t].data[m].partDeep)+.75){var C={key:Math.floor(this.tableData[t].data[m].partDeep)+.75,value:Number(this.tableData[t].data[m].partPulp.toFixed(2))};n.push(C);var y={};n.forEach((function(t){y[t.key]?y[t.key]+=t.value:y[t.key]=t.value}))}if(this.tableData[t].data[m].partDeep==Math.floor(this.tableData[t].data[m].partDeep)){var w={key:Math.floor(this.tableData[t].data[m].partDeep),value:Number(this.tableData[t].data[m].partPulp.toFixed(2))};o.push(w);var k={};o.forEach((function(t){k[t.key]?k[t.key]+=t.value:k[t.key]=t.value}))}if(null==c[Math.ceil(this.tableData[t].data[m].partDeep-1)]&&(c[Math.ceil(this.tableData[t].data[m].partDeep-1)]=0),c[Math.ceil(this.tableData[t].data[m].partDeep-1)]+=Number(this.tableData[t].data[m].partAsh.toFixed(2)),null==h[Math.ceil(this.tableData[t].data[m].partDeep-1)]&&(h[Math.ceil(this.tableData[t].data[m].partDeep-1)]=0),h[Math.ceil(this.tableData[t].data[m].partDeep-1)]=Number(this.tableData[t].data[m].partCurrent.toFixed(2)),this.tableData[t].data[m].partDeep>0&&this.tableData[t].data[m].partDownSpeed>0)if(null==p.get(Math.ceil(this.tableData[t].data[m].partDeep))){var x=[];x.push(this.tableData[t].data[m].partDownSpeed),p.set(Math.ceil(this.tableData[t].data[m].partDeep),x)}else{var _=p.get(Math.ceil(this.tableData[t].data[m].partDeep));_.push(this.tableData[t].data[m].partDownSpeed),p.set(Math.ceil(this.tableData[t].data[m].partDeep),_)}if(this.tableData[t].data[m].partDownSpeed<0)if(null==d.get(Math.ceil(this.tableData[t].data[m].partDeep))){var S=[];S.push(this.tableData[t].data[m].partDownSpeed),d.set(Math.ceil(this.tableData[t].data[m].partDeep),S)}else{var F=d.get(Math.ceil(this.tableData[t].data[m].partDeep));F.push(this.tableData[t].data[m].partDownSpeed),d.set(Math.ceil(this.tableData[t].data[m].partDeep),F)}}for(var A=[],E=0;E<h.length;E++){var I={key:E,value:h[E]};A.push(I)}A.forEach((function(t){e.partcurrent[t.key]?e.partcurrent[t.key]+=t.value:e.partcurrent[t.key]=t.value}));var M=[];d.forEach((function(t){M.push(t)}));for(var T=[],R=0,L=0;L<M.length;L++){for(var Y=0;Y<M[L].length;Y++)R+=M[L][Y];var z=Math.abs((R/M[L].length).toFixed(2));T.push(z),R=0}T=T.reverse();for(var N=[],P=0;P<T.length;P++){var U={key:P,value:T[P]};N.push(U)}N.forEach((function(t){e.upspeed[t.key]?e.upspeed[t.key]+=t.value:e.upspeed[t.key]=t.value}));var j=[];p.forEach((function(t){j.push(t)}));for(var Z=[],G=0,H=0;H<j.length;H++){for(var V=0;V<j[H].length;V++)G+=j[H][V];var W=Number((G/j[H].length).toFixed(2));Z.push(W),G=0}for(var J=[],B=0;B<Z.length;B++){var Q={key:B,value:Z[B]};J.push(Q)}J.forEach((function(t){e.downspeed[t.key]?e.downspeed[t.key]+=t.value:e.downspeed[t.key]=t.value}));for(var O=[],X=0;X<c.length;X++){var $={key:X,value:c[X]};O.push($)}O.forEach((function(t){e.ashReport[t.key]?e.ashReport[t.key]+=t.value:e.ashReport[t.key]=t.value})),this.depthReport.unshift(0),this.depthReport.splice(this.depthReport.length-1,1),this.pulpReport=Object.assign(b,D,y,k)},selectionChange:function(t){this.checkedData=t.reverse();for(var e=[],a=0;a<t.length;a++)e.push(t[a].data);for(var s=[],r=[],l=[],n=[],o=0;o<e.length;o++){for(var c=0;c<e[o].length;c++)e[o][c].partDownSpeed>0&&s.push([e[o][c].partDeep,e[o][c].partTime,e[o][c].partDownSpeed]),e[o][c].partDownSpeed<0&&n.push([e[o][c].partDeep,e[o][c].partTime,e[o][c].partDownSpeed]);r.push(s),l.push(n),n=[],s=[]}for(var h=[],p=0;p<r.length;p++){for(var d=1;d<r[p].length;d++)if(r[p][d-1][0]>r[p][d][0])var m=d;0!=m&&null!=m||(m=r[p].length),h.push(m),m=0}for(var u=[],f=[],v=0;v<r.length;v++)u.push(r[v].slice(0,h[v])),f.push(r[v].slice(h[v]));for(var b=0,g=0,D=0;D<u.length;D++){for(var C=0;C<u[D].length;C++)b+=u[D][C][1],g+=u[D][C][1]*u[D][C][2];g/b=="Infinity"||0==u[D].length?this.checkedData[D].speed1=0:this.checkedData[D].speed1=(g/b).toFixed(2),b=0,g=0}for(var y=0,w=0,k=0;k<f.length;k++){for(var x=0;x<f[k].length;x++)y+=f[k][x][1],w+=f[k][x][1]*f[k][x][2];w/y=="Infinity"||0==f[k].length?this.checkedData[k].speed2=0:this.checkedData[k].speed2=(w/y).toFixed(2),y=0,w=0}for(var _=[],S=0;S<l.length;S++){for(var F=1;F<l[S].length;F++)if(l[S][F-1][0]<l[S][F][0])var A=F;0!=A&&null!=A||(A=l[S].length),_.push(A),A=0}for(var E=[],I=[],M=0;M<l.length;M++)E.push(l[M].slice(0,_[M])),I.push(l[M].slice(_[M]));for(var T=0,R=0,L=0;L<E.length;L++){for(var Y=0;Y<E[L].length;Y++)T+=E[L][Y][1],R+=E[L][Y][1]*E[L][Y][2];R/T=="Infinity"||0==E[L].length?this.checkedData[L].speed3=0:this.checkedData[L].speed3=Math.abs((R/T).toFixed(2)),T=0,R=0}for(var z=0,N=0,P=0;P<I.length;P++){for(var U=0;U<I[P].length;U++)z+=I[P][U][1],N+=I[P][U][1]*I[P][U][2];N/z=="Infinity"||0==I[P].length?this.checkedData[P].speed4=0:this.checkedData[P].speed4=Math.abs((N/z).toFixed(2)),z=0,N=0}this.checkedData.startDate=i(1e3*this.checkedData[0].beginTime).format("YYYY-MM-DD HH:mm:ss"),this.checkedData.endDate=i(1e3*this.checkedData[this.checkedData.length-1].endTime).format("YYYY-MM-DD HH:mm:ss"),this.checkedData.milePartNo=this.checkedData[this.checkedData.length-1].milePartNo,this.checkedId=[];for(var j=0;j<t.length;j++)this.checkedId.push(t[j]._id);t.length==this.tableData.length?this.totalChecked=!0:this.totalChecked&&(this.totalChecked=!1)},totalChange:function(t){t?(this.$refs.table.clearSelection(),this.$refs.table.toggleAllSelection()):this.$refs.table.clearSelection()},handleSizeChange:function(t){var e=this,a=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.pageSize=t,n(this.tab,0,this.device,this.pageSize,this.pileDescribe).then((function(t){e.tableData=t.content,e.total=t.totalElements,e.warnReason(),a.close()})),setTimeout((function(){a.close()}),6e3)},handleCurrentChange:function(t){var e=this,a=this.$loading({lock:!0,text:"Loading",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.7)"});this.currentPage=t,n(this.tab,this.currentPage-1,this.device,this.pageSize,this.pileDescribe).then((function(t){e.tableData=t.content,e.total=t.totalElements,e.warnReason(),a.close()})),setTimeout((function(){a.close()}),6e3)},toFirstPage:function(){this.handleCurrentChange(1)},toLastPage:function(){this.handleCurrentChange(Math.ceil(this.total/this.pageSize))}}},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row-history"},[a(t.report,{tag:"component",attrs:{partcurrent:t.partcurrent,downspeed:t.downspeed,upspeed:t.upspeed,ashReport:t.ashReport,selectItem:t.selectItem,checkedData:t.checkedData,depthReport:t.depthReport,pulpReport:t.pulpReport}}),a("a",{attrs:{id:"simulation",href:""}}),a("el-container",{staticClass:"row-con"},[a("el-header",{staticClass:"m-filter"},[a("div",{staticClass:"wp"},[a("div",{staticClass:"filter"},[a("el-form",{ref:"filter",staticClass:"m-filterbox"},[a("div",{staticClass:"right"},[a("el-button",{staticClass:"btn btn-search",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.querychxun}},[t._v("查询 ")]),a("el-button",{staticClass:"btn btn-reset",attrs:{"native-type":"reset"},on:{click:t.resetClick}},[a("span",{staticClass:"icon icon-reset"}),a("span",[t._v("重置")])]),a("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.showData()}}},[t._v("选择参数")])],1),a("div",{staticClass:"left"},[a("el-form-item",{staticClass:"item picker picker-device"},[a("el-select",{attrs:{placeholder:"请选择设备"},model:{value:t.device,callback:function(e){t.device=e},expression:"device"}},t._l(t.deviceList,(function(t){return a("el-option",{key:t.key,attrs:{label:t.name,value:t.key}})})),1)],1),a("el-form-item",{staticClass:"item input"},[a("el-input",{staticClass:"input",attrs:{placeholder:"请输入桩号"},model:{value:t.pileDescribe,callback:function(e){t.pileDescribe=e},expression:"pileDescribe"}})],1)],1)])],1)])]),a("el-main",{staticClass:"m-table-main"},[a("div",{attrs:{id:"table-content"}},[a("el-table",{ref:"table",staticClass:"jbThead",staticStyle:{width:"100%"},attrs:{"cell-style":t.backgroundColor,data:t.tableData,"row-key":"id",align:"center","tree-props":{children:"children",hasChildren:"hasChildren"}},on:{"selection-change":t.selectionChange}},[a("el-table-column",{attrs:{type:"selection",align:"center",fixed:""}}),t._l(t.cols,(function(t,e){return a("el-table-column",{key:e,attrs:{prop:t.prop,label:t.label,formatter:t.formatter,"min-width":"145px",align:"center","show-overflow-tooltip":""}})})),a("el-table-column",{attrs:{fixed:"right",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"m-edit-btns"},[a("div",{staticClass:"item"},[a("a",{staticClass:"btn",attrs:{href:"javascript:"},on:{click:function(a){return t.handleCommand(e.$index)}}},[t._v("详情")])])])]}}])})],2)],1)]),a("el-dialog",{attrs:{title:"选择需要展示的参数",visible:t.dialogFormVisible,width:"40%",center:"",top:"15vh"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[a("el-checkbox",{attrs:{indeterminate:t.isIndeterminate},on:{change:t.handleCheckAllChange},model:{value:t.checkAll,callback:function(e){t.checkAll=e},expression:"checkAll"}},[t._v("全选 ")]),a("div",{staticStyle:{margin:"15px 0"}}),a("el-checkbox-group",{on:{change:t.handleCheckedCitiesChange},model:{value:t.checkedFileds,callback:function(e){t.checkedFileds=e},expression:"checkedFileds"}},t._l(t.fieldNames,(function(e){return a("el-checkbox",{key:e.prop,attrs:{label:e.prop}},[t._v(t._s(e.label)+" ")])})),1),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"medium"},on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary",size:"medium"},on:{click:t.confirmShow}},[t._v("确定")])],1)],1)],1),a("el-dialog",{staticClass:"m-pop m-pop-detail",attrs:{visible:t.centerDialogVisible},on:{"update:visible":function(e){t.centerDialogVisible=e}}},[a("div",{staticClass:"dialog-header",attrs:{slot:"title"},slot:"title"},[a("div",{staticClass:"left"},[a("gTabs",{attrs:{current:t.tab2,list:t.tab2List},on:{change:t.changeHandle}})],1),a("div",{staticClass:"right"},[a("el-dropdown",{attrs:{trigger:"click",placement:"top-start"},on:{command:t.downLoad}},[a("span",{staticClass:"more"},[t._v("报表下载 ")]),a("el-dropdown-menu",{staticClass:"g-dropdown",attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:0}},[a("span",{staticClass:"icon icon01"}),a("span",{staticClass:"name"},[t._v("打印版")])]),a("el-dropdown-item",{attrs:{command:1}},[a("span",{staticClass:"icon icon02"}),a("span",{staticClass:"name"},[t._v("综合版")])]),a("el-dropdown-item",{attrs:{command:2}},[a("span",{staticClass:"icon icon03"}),a("span",{staticClass:"name"},[t._v("详细版")])])],1)],1)],1)]),a("div",{staticClass:"dialog-content"},[a("div",{directives:[{name:"show",rawName:"v-show",value:0===t.tab2,expression:"tab2 === 0"}],staticClass:"m-tab-table m-tab-detail"},[a("div",{staticClass:"m-table-detail"},[a("div",{staticClass:"detailitem"},[a("h3",[t._v("详细数据")]),a("div",{staticClass:"box"},[a("ul",{staticClass:"ul-detail"},[a("li",{staticClass:"s1"},[a("div",{staticClass:"inner"},[a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("桩号")]),a("div",{staticClass:"value valuepile",attrs:{title:this.selectItem.pileDescribe}},[t._v(" "+t._s(t.selectItem.pileDescribe)+" ")])]),a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("桩机编号")]),a("div",{staticClass:"value"},[t._v(t._s(t.selectItem.deviceKey))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("开始时间")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("datafilters")(t.selectItem.beginTime)))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("结束时间")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("datafilters")(t.selectItem.endTime)))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("施工桩长")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("numfilters")(t.selectItem.depth))+"(m)")])])])]),a("li",{staticClass:"s2"},[a("div",{staticClass:"inner"},[a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("初搅深度(m)")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("numfilters")(t.selectItem.frDepth)))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("累计浆量(L)")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("numfilters")(t.selectItem.cumulativeAsh)))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("累计灰量(kg)")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("numfilters")(t.selectItem.cumulativeAsh)))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("平均浆量(L/m)")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("numfilters")(t.selectItem.averagePulp)))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("平均灰量(kg/m)")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("numfilters")(t.selectItem.averageAsh)))])])])]),a("li",{staticClass:"s3"},[a("div",{staticClass:"inner"},[a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("平均密度(g/cm³)")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("densityfilter")(t.selectItem.waterCementRatio)))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("成桩时间(min)")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("minfilters")(t.selectItem.pileTime)))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("复搅深度(m)")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("numfilters")(t.selectItem.reDepth)))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("下钻速度(cm/min)")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("numfilters")(t.selectItem.downSpeed)))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("提钻速度(cm/min)")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("numfilters")(t.selectItem.upSpeed)))])])])]),a("li",{staticClass:"s4"},[a("div",{staticClass:"inner"},[a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("桩端电流(A)")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("numfilters")(t.selectItem.pileTopCurrent)))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("最大电流(A)")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("numfilters")(t.selectItem.maxCurrent)))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("空搅深度(m)")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("numfilters")(t.selectItem.emDepth)))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("最大斜度(%)")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("num1filters")(t.selectItem.xAngle)))])]),a("div",{staticClass:"item"},[a("div",{staticClass:"tit"},[t._v("喷浆压力(Mpa)")]),a("div",{staticClass:"value"},[t._v(t._s(t._f("numfilters")(t.selectItem.averagePressure)))])])])])])])]),a("br"),a("h3",[t._v("段数据列表")]),a("el-table",{ref:"saveTable",staticClass:"m-table-save",staticStyle:{width:"100%","margin-top":"20px"},attrs:{data:t.selectItem.data,height:"28em"}},[a("el-table-column",{attrs:{property:"partId",label:"序号","min-width":"8.33%",align:"center"}}),a("el-table-column",{attrs:{property:"partDeep",label:"段深度(m)","min-width":"8.33%",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("numfilters")(e.row.partDeep))+" ")]}}])}),a("el-table-column",{attrs:{property:"partPulp",label:"段浆量(L)","min-width":"8.33%",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("numfilters")(e.row.partPulp))+" ")]}}])}),a("el-table-column",{attrs:{property:"partAsh",label:"段灰量(kg)","min-width":"8.33%",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("numfilters")(e.row.partAsh))+" ")]}}])}),a("el-table-column",{attrs:{property:"partCurrent",label:"段电流(A)","min-width":"8.33%",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("numfilters")(e.row.partCurrent))+" ")]}}])}),a("el-table-column",{attrs:{property:"partDensity",label:"段密度(g/cm³)","min-width":"8.33%",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("num2filters")(e.row.partDensity))+" ")]}}])}),a("el-table-column",{attrs:{property:"partDownSpeed",label:"速度(cm/min)","min-width":"8.33%",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("num3filters")(e.row.partDownSpeed))+" ")]}}])}),a("el-table-column",{attrs:{property:"partPressure",label:"段喷压(MPa)","min-width":"8.33%",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("numfilters")(e.row.partPressure))+" ")]}}])}),a("el-table-column",{attrs:{property:"partTime",label:"段时长(s)","min-width":"8.33%",align:"center"}}),a("el-table-column",{attrs:{property:"partDownSpeed",label:"状态","min-width":"8.33%",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(" "+t._s(t._f("num5filters")(e.row.partDownSpeed))+" ")]}}])})],1)],1)]),a("div",{directives:[{name:"show",rawName:"v-show",value:1===t.tab2,expression:"tab2 === 1"}],staticClass:"m-tab-table m-tab-echartTable"},[a("div",{staticClass:"m-pop-echart"},[a("el-row",{staticClass:"row"},[a("el-col",{staticClass:"col",attrs:{span:12}},[a("div",{staticClass:"inner"},[a("div",{ref:"myChart01",style:{width:"100%",height:"100%"}})])]),a("el-col",{staticClass:"col",attrs:{span:12}},[a("div",{staticClass:"inner"},[a("div",{ref:"myChart02",style:{width:"100%",height:"100%"}})])])],1),a("el-row",{staticClass:"row"},[a("el-col",{staticClass:"col",attrs:{span:12}},[a("div",{staticClass:"inner"},[a("div",{ref:"myChart03",style:{width:"100%",height:"100%"}})])]),a("el-col",{staticClass:"col",attrs:{span:12}},[a("div",{staticClass:"inner"},[a("div",{ref:"myChart04",style:{width:"100%",height:"100%"}})])])],1)],1)])])]),a("el-footer",{staticClass:"m-selectAll"},[a("div",{staticClass:"left"},[a("div",{staticClass:"item"},[a("el-checkbox",{staticClass:"total",on:{change:t.totalChange},model:{value:t.totalChecked,callback:function(e){t.totalChecked=e},expression:"totalChecked"}},[t._v("全选 ")])],1),a("div",{staticClass:"item"},[a("a",{staticClass:"export",on:{click:t.checkall}},[t._v("导出")])])]),a("div",{staticClass:"right"},[a("el-pagination",{staticClass:"pages",attrs:{"current-page":t.currentPage,"page-sizes":[10,20,40],"page-size":t.pageSize,layout:"slot, prev, pager,next",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},[a("button",{staticClass:"lastPage",on:{click:t.toFirstPage}},[a("i",{staticClass:"el-icon-d-arrow-left"})])]),a("el-pagination",{staticClass:"pages",attrs:{"current-page":t.currentPage,"page-sizes":[10,20,40],"page-size":t.pageSize,layout:"slot, jumper, sizes",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}},[a("button",{staticClass:"lastPage",on:{click:t.toLastPage}},[a("i",{staticClass:"el-icon-d-arrow-right"})])])],1)])],1)}),[],!1,d,"00538f19",null,null);function d(t){for(var e in h)this[e]=h[e]}t("default",function(){return p.exports}())}}}))}();
